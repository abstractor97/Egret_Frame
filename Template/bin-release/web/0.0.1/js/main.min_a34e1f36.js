var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function s(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(s,a)}c((i=i.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return i([e,t])}}function i(n){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,o&&(s=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(s=c.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){c.label=n[1];break}if(6===n[0]&&c.label<s[1]){c.label=s[1],s=n;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(n);break}s[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(i){n=[6,i],o=0}finally{r=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,o,s,a,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},Layer=function(e){function t(){var t=e.call(this)||this;return t.TAG="",t.CustomUIEventList=null,t.TAG=egret.getQualifiedClassName(t),t.addEventListener(egret.Event.ADDED_TO_STAGE,t.init,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onDestroy,t),t}return __extends(t,e),t.prototype.init=function(){console.log(this.TAG+" init"),this._registerCustomUIEventsList(!0),this.setOnTouchListener(),this.watchData()},t.prototype.watchData=function(){},t.prototype._registerCustomUIEventsList=function(e){if(this.CustomUIEventList)for(var t=0,n=this.CustomUIEventList;t<n.length;t++){var i=n[t],r=i.toString(),o="ui_"+r;this[o]?e?EventManager.getInstance().register(r,this[o],this):EventManager.getInstance().unRegister(r,this[o],this):console.error("未添加"+this.TAG+"的"+o+"的监听")}},t.prototype.setOnTouchListener=function(){},t.prototype.removeOnTouchListener=function(){},t.prototype.onDestroy=function(){console.log(this.TAG+" onDestroy"),this._registerCustomUIEventsList(!1),this.removeOnTouchListener(),this.CustomUIEventList=null},t}(eui.Component);__reflect(Layer.prototype,"Layer");var Scene=function(e){function t(){var t=e.call(this)||this;return t.TAG="",t.TAG=egret.getQualifiedClassName(t),t.addEventListener(egret.Event.ADDED_TO_STAGE,t.init,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onDestroy,t),t}return __extends(t,e),t.prototype.init=function(){console.log(this.TAG+" init"),this._isRunning=!0},Object.defineProperty(t.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),t.prototype.onEnterTransitionDidFinish=function(){},t.prototype.onExitTransitionDidStart=function(){},t.prototype.onDestroy=function(){console.log(this.TAG+" onDestroy"),this.removeChildren()},t}(eui.UILayer);__reflect(Scene.prototype,"Scene");var Single=function(){function e(){}return e.getInstance=function(){var e=egret.getQualifiedClassName(this),t=egret.getDefinitionByName(e);return this._instance||(this._instance=new t),this._instance},e}();__reflect(Single.prototype,"Single");var ScrollerList=function(e){function t(){var t=e.call(this)||this;return t._list=new eui.List,t._scroller=new eui.Scroller,t._scroller.bounces=!1,t._scroller.viewport=t._list,t.addChild(t._scroller),t.addEventListener(egret.Event.RESIZE,t._onResize,t),t._list.addEventListener(eui.ItemTapEvent.ITEM_TAP,t._onItemTap,t),t}return __extends(t,e),t.prototype._onResize=function(){this._scroller.width=this.width,this._scroller.height=this.height},t.prototype._onItemTap=function(e){this.dispatchEvent(e)},Object.defineProperty(t.prototype,"dataProvider",{get:function(){return this._list.dataProvider},set:function(e){this._list.dataProvider=e,this.addEventListener(egret.Event.ENTER_FRAME,this._onEnterFrame,this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemRender",{get:function(){return this._list.itemRenderer},set:function(e){this._list.itemRenderer=e,this.addEventListener(egret.Event.ENTER_FRAME,this._onEnterFrame,this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemRendererSkinName",{get:function(){return this._list.itemRendererSkinName},set:function(e){this._list.itemRendererSkinName=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this._list.selectedIndex},set:function(e){this._list.selectedIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedItem",{get:function(){return this._list.selectedItem},set:function(e){this._list.selectedItem=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowMultipleSelection",{get:function(){return this._list.allowMultipleSelection},set:function(e){this._list.allowMultipleSelection=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedIndices",{get:function(){return this._list.selectedIndices},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useVirtualLayout",{get:function(){return this._list.useVirtualLayout},set:function(e){this._list.useVirtualLayout=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layout",{get:function(){return this._list.layout},set:function(e){this._list.layout=e},enumerable:!0,configurable:!0}),t.prototype.getTileLayout=function(){return new eui.TileLayout},t.prototype.getVerticalLayout=function(){return new eui.VerticalLayout},t.prototype._onEnterFrame=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this._onEnterFrame,this),this._onResize();var e=this._list.dataProvider,t=this._doDateTxt;e&&0==e.length&&(t||(t=this._doDateTxt=new eui.Label("目前列表为空"),t.size=18,this.addChild(t),t.horizontalCenter=0,t.verticalCenter=0)),t&&(t.visible=0==e.length)},t}(eui.Component);__reflect(ScrollerList.prototype,"ScrollerList");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,i){function r(e){t.call(i,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(i))}"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(i,generateEUI)},this):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT))},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return[4,this.loadResource()];case 1:return n.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return e=n.sent(),[4,platform.init()];case 3:return n.sent(),[4,platform.getUserInfo()];case 4:return t=n.sent(),console.log(t),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,this.loadTheme()];case 2:return n.sent(),[4,RES.loadGroup("preload",0,e)];case 3:return n.sent(),this.stage.removeChild(e),[3,5];case 4:return t=n.sent(),console.error(t),[3,5];case 5:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,n){var i=new eui.Theme("resource/default.thm.json",e.stage);i.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){SceneManager.Instance.runWithScene(SceneConst[SceneConst.LoginScene])},t}(eui.UILayer);__reflect(Main.prototype,"Main");var EventManager=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return this.instance||(t.instance=new t),t.instance},t.prototype.dispatchCustomEvent=function(e,n){t.instance.dispatchEventWith(e,!1,n)},t.prototype.register=function(e,n,i){t.instance.addEventListener(e,n,i)},t.prototype.unRegister=function(e,n,i){t.instance.removeEventListener(e,n,i)},t}(egret.EventDispatcher);__reflect(EventManager.prototype,"EventManager");var EffectType;!function(e){e[e.None=0]="None",e[e.Slight=1]="Slight",e[e.Violent=2]="Violent"}(EffectType||(EffectType={}));var PopupManager=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._popUpLayerList={},t}return __extends(t,e),Object.defineProperty(t,"Instance",{get:function(){return this.getInstance()},enumerable:!0,configurable:!0}),t.prototype.open=function(e,t,n){void 0===t&&(t=!1);var i=SceneManager.Instance.runningScene;if(!i.contains(this._popUpLayerList[e])){var r=egret.getDefinitionByName(e),o=new r;i.addChild(o),this._popUpLayerList[e]=o,this._playEffect(o,n)}},t.prototype._playEffect=function(e,t){switch(t){case EffectType.None:break;case EffectType.Slight:e.alpha=0,e.scaleX=.5,e.scaleY=.5,egret.Tween.get(e).to({alpha:1,scaleX:1,scaleY:1},300,egret.Ease.backOut);break;case EffectType.Violent:e.alpha=0,e.scaleX=.5,e.scaleY=.5,egret.Tween.get(e).to({alpha:1,scaleX:1,scaleY:1},600,egret.Ease.elasticOut)}},t.prototype.close=function(e,t){var n=SceneManager.Instance.runningScene;if(e||n.contains(this._popUpLayerList[e])){var i=this._popUpLayerList[e];switch(t){case 0:break;case 1:egret.Tween.get(i).to({alpha:0,scaleX:0,scaleY:0,x:i.x+i.width/2,y:i.y+i.height/2},300);break;case 2:break;case 3:egret.Tween.get(i).to({x:i.width},500,egret.Ease.cubicOut);break;case 4:egret.Tween.get(i).to({x:-i.width},500,egret.Ease.cubicOut);break;case 5:egret.Tween.get(i).to({y:i.height},500,egret.Ease.cubicOut);break;case 6:egret.Tween.get(i).to({y:-i.height},500,egret.Ease.cubicOut)}var r=500;0==t&&(r=0),egret.setTimeout(function(){i&&n.contains(i)&&(n.removeChild(i),this._popUpLayerList[e]=null,delete this._popUpLayerList[e])},this,r)}},t}(Single);__reflect(PopupManager.prototype,"PopupManager");var SceneManager=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._runningScene=null,t._scenesStack=[],t._nextScene=null,t}return __extends(t,e),Object.defineProperty(t,"Instance",{get:function(){return this.getInstance()},enumerable:!0,configurable:!0}),t.prototype.runWithScene=function(e){console.assert(null!=e,"This command can only be used to start the SceneManager. There is already a scene present."),console.assert(null==this._runningScene,"_runningScene should be null"),this.pushScene(e)},t.prototype.replaceScene=function(e){if(console.assert(null!=e,"the scene should not be null"),null==this._runningScene)return void this.runWithScene(e);var t=egret.getDefinitionByName(e),n=new t;if(n!=this._nextScene){this._nextScene&&(this._nextScene.isRunning&&this._nextScene.parent.removeChild(this._nextScene),this._nextScene=null),this._sendCleanupToScene=!0;var i=this._scenesStack.length;this._scenesStack.splice(i-1,1,n),this._nextScene=n,this._setNextScene()}},t.prototype.pushScene=function(e){console.assert(null!=e,"the scene should not null"),this._sendCleanupToScene=!1;var t=egret.getDefinitionByName(e),n=new t;this._scenesStack.push(n),this._nextScene=n,this._setNextScene()},t.prototype.popScene=function(){console.assert(null!=this._runningScene,"running scene should not null"),this._scenesStack.pop();var e=this._scenesStack.length;0==e||(this._sendCleanupToScene=!0,this._nextScene=this._scenesStack[e-1],this._setNextScene())},t.prototype._setNextScene=function(){egret.MainContext.instance.stage.addChild(this._nextScene),this._runningScene&&this._runningScene.onExitTransitionDidStart(),this._nextScene.onEnterTransitionDidFinish(),this._sendCleanupToScene&&this._runningScene&&this._runningScene.parent.removeChild(this._runningScene),this._runningScene=this._nextScene,this._nextScene=null},Object.defineProperty(t.prototype,"runningScene",{get:function(){return this._runningScene},enumerable:!0,configurable:!0}),t}(Single);__reflect(SceneManager.prototype,"SceneManager");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return console.log("start nest init"),e={},e.egretAppId=88888,e.version=2,e.debug=!0,nest.easyuser.startup(e,function(e){0==e.result?platform.login():console.log("nest init fail")}),[2]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){return console.log("login start"),e=nest.easyuser.getLoginTypes(),e.length?(t=e[0],1!=e.length||"wx"!=t.loginType&&"qq"!=t.loginType||nest.easyuser.login(t,function(e){0==e.result?console.log("log success"):console.log("log fail")})):nest.easyuser.login({},function(e){0==e.result?(console.log("no need success"),egret.log("log Success")):egret.log("log Fail")}),[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function i(i){t.call(n,i,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?i(r):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var SceneConst;!function(e){e[e.LoginScene=0]="LoginScene",e[e.HallScene=1]="HallScene",e[e.GameScene=2]="GameScene"}(SceneConst||(SceneConst={}));var PopUpLayers;!function(e){e[e.ShopLayer=0]="ShopLayer"}(PopUpLayers||(PopUpLayers={}));var HallMenu=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.menu_list.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onItemTap,this)},t.prototype._onItemTap=function(e){console.log(e.itemIndex)},t}(eui.Component);__reflect(HallMenu.prototype,"HallMenu");var Rank=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this);for(var t=[],n=0;100>n;n++){var i={};i.No=n,i.name="lucy"+n,t.push(i)}var r=new eui.VerticalLayout;this.rankList.layout=r;var o=new eui.ArrayCollection(t);this.rankList.dataProvider=o},t}(eui.Component);__reflect(Rank.prototype,"Rank");var PlayerStateItemRender=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.dataChanged=function(){this.usernameTxt.text=this.data.username,this.onlineTxt.text=1==this.data.online?"在线":"离线"},t}(eui.ItemRenderer);__reflect(PlayerStateItemRender.prototype,"PlayerStateItemRender");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.percentWidth=100,this.percentHeight=100,this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(Layer);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var HallLayer=function(e){function t(){var t=e.call(this)||this;return t.skinName="Skin.Hall",t.percentWidth=100,t.percentHeight=100,t}return __extends(t,e),t.prototype.init=function(){e.prototype.init.call(this)},t.prototype.setOnTouchListener=function(){this.player.addEventListener(eui.ItemTapEvent.ITEM_TAP,this._onItemTap,this),this.gameEntryList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this._onItemTap,this),this.menu_list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this._onItemTap,this),this.virtuallayout.addEventListener(egret.Event.CHANGE,this._onChange,this),this.btn_new.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnNewClick,this)},t.prototype.removeOnTouchListener=function(){this.player.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this._onItemTap,this),this.gameEntryList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this._onItemTap,this),this.menu_list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this._onItemTap,this),this.virtuallayout.removeEventListener(egret.Event.CHANGE,this._onChange,this)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this);for(var t=[],n=0;100>n;n++){var i={};i.name=n,i.price=100+n,t.push(i)}this.virtual.text=1==this.player.useVirtualLayout?"开启":"关闭";var r=this.player.getVerticalLayout();r.horizontalAlign=eui.JustifyAlign.JUSTIFY,this.player.layout=r,this.arrCol=new eui.ArrayCollection(t),this.player.dataProvider=this.arrCol},t.prototype._onChange=function(e){this.virtuallayout.selected?this.player.useVirtualLayout=!0:this.player.useVirtualLayout=!1,this.virtuallayout.selected?this.virtual.text="开启":this.virtual.text="关闭",console.log(this.virtual.text)},t.prototype._onItemTap=function(e){console.log(e.itemIndex),PopupManager.Instance.open(PopUpLayers[PopUpLayers.ShopLayer],!1,EffectType.Violent)},t.prototype._onBtnNewClick=function(){console.log(this.arrCol.getItemAt(0));var e=this.arrCol.getItemAt(0);console.log(this.arrCol.getItemIndex(e))},t}(Layer);__reflect(HallLayer.prototype,"HallLayer");var ShopLayer=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.Shop",t.percentWidth=100,t.percentHeight=100,t}return __extends(t,e),t.prototype.init=function(){e.prototype.init.call(this)},t.prototype.setOnTouchListener=function(){this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onCloseClick,this)},t.prototype.removeOnTouchListener=function(){},t.prototype._onCloseClick=function(){PopupManager.Instance.close(PopUpLayers[PopUpLayers.ShopLayer],1)},t}(Layer);__reflect(ShopLayer.prototype,"ShopLayer");var LoginLayer=function(e){function t(){var t=e.call(this)||this;return t.skinName="Skin.LoginLayer",t.percentWidth=100,t.percentHeight=100,t}return __extends(t,e),t.prototype.init=function(){e.prototype.init.call(this)},t.prototype.setOnTouchListener=function(){this.btn_login.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginClick,this)},t.prototype.removeOnTouchListener=function(){this.btn_login.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginClick,this)},t.prototype.onLoginClick=function(){SceneManager.Instance.replaceScene(SceneConst[SceneConst.HallScene])},t}(Layer);__reflect(LoginLayer.prototype,"LoginLayer");var HallScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.init=function(){var e=new HallLayer;this.addChild(e)},t}(Scene);__reflect(HallScene.prototype,"HallScene");var LoginScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.init=function(){e.prototype.init.call(this),this.loginLayer=new LoginLayer,this.addChild(this.loginLayer)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this.loginLayer=null},t}(Scene);__reflect(LoginScene.prototype,"LoginScene");